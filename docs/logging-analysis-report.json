{
  "analysis_summary": {
    "file_analyzed": "PokeSharp.Engine.Common/Logging/GameLoggingExtensions.cs",
    "total_manual_logging_calls": 15,
    "methods_with_manual_logging": 7,
    "existing_log_templates_available": 120,
    "conversion_opportunities": 15
  },
  "manual_logging_calls_by_method": {
    "LogEntityCreated": {
      "line_numbers": [40],
      "current_implementation": "logger.LogInformation(message, args.ToArray())",
      "issues": [
        "Dynamic message construction with string concatenation",
        "No Spectre markup for colored output",
        "Uses dynamic args list instead of structured logging"
      ],
      "recommended_fix": "Use existing LogTemplates.LogEntityCreated()",
      "existing_template": "LogEntityCreated (lines 116-126 in LogTemplates.cs)",
      "suggested_spectre_markup": "[gold1]E[/] [yellow]{entityType}[/] [dim]#{entityId}[/]",
      "priority": "HIGH",
      "benefits": [
        "Consistent formatting with Entity accent ([gold1]E[/])",
        "Component list formatting with FormatComponents helper",
        "Better performance with pre-formatted templates"
      ]
    },
    "LogComponentAdded": {
      "line_numbers": [61, 70],
      "current_implementation": "logger.LogDebug(...)",
      "issues": [
        "Conditional logic duplicates similar log messages",
        "No colored output",
        "Manual structured logging without template reuse"
      ],
      "recommended_fix": "Add new LogTemplate method",
      "suggested_template": {
        "name": "LogComponentAdded",
        "accent": "Entity",
        "color_scheme": "[gold1]E[/] [dim]Component added[/] | entity: [yellow]{entityId}[/] | component: [cyan]{componentType}[/]",
        "optional_data": "Include componentData with [@ComponentData] for structured serialization"
      },
      "priority": "MEDIUM",
      "benefits": [
        "Eliminate duplicate log messages",
        "Add colored visual hierarchy",
        "Consistent with other entity operations"
      ]
    },
    "LogSystemExecution": {
      "line_numbers": [97, 106],
      "current_implementation": "logger.LogWarning/LogDebug with conditional threshold check",
      "issues": [
        "Conditional logic based on execution time",
        "No Spectre markup",
        "Similar to existing LogSystemPerformance template"
      ],
      "recommended_fix": "Use existing LogTemplates.LogSystemPerformance() or LogSlowSystem()",
      "existing_templates": [
        "LogSystemPerformance (lines 232-257 in LogTemplates.cs)",
        "LogSlowSystem (lines 301-343 in LogTemplates.cs)"
      ],
      "migration_strategy": "Replace conditional with LogSlowSystem for >16.67ms, LogSystemPerformance for normal logging",
      "priority": "HIGH",
      "benefits": [
        "Colored severity indicators (green/yellow/red)",
        "Consistent performance formatting",
        "Frame percentage calculations"
      ]
    },
    "LogWorkflow": {
      "line_numbers": [143],
      "current_implementation": "Dynamic message with metadata concatenation",
      "issues": [
        "Has 'WF' prefix but no Spectre markup",
        "Dynamic message construction"
      ],
      "recommended_fix": "Use existing LogTemplates.LogWorkflowStatus()",
      "existing_template": "LogWorkflowStatus (lines 175-184 in LogTemplates.cs)",
      "suggested_spectre_markup": "[steelblue1]WF[/] [cyan]{workflowName}[/] | status: [yellow]{status}[/]",
      "priority": "MEDIUM",
      "benefits": [
        "Workflow accent with proper color ([steelblue1]WF[/])",
        "FormatDetails helper for metadata",
        "Consistent workflow logging pattern"
      ]
    },
    "BeginTimedOperation_TimedOperationScope": {
      "line_numbers": [249, 259, 268],
      "current_implementation": "Manual LogDebug/LogWarning in nested class",
      "issues": [
        "Three separate manual log calls in TimedOperationScope",
        "No Spectre markup",
        "Threshold-based conditional similar to performance templates"
      ],
      "recommended_fix": "Use existing LogTemplates.LogSlowOperation()",
      "existing_template": "LogSlowOperation (lines 286-296 in LogTemplates.cs)",
      "migration_strategy": "Replace Dispose() logging with LogSlowOperation for slow paths, LogSystemUpdateCompleted for normal paths",
      "priority": "MEDIUM",
      "benefits": [
        "Performance accent with colored thresholds",
        "Consistent with system performance logging",
        "Eliminates nested manual logging"
      ]
    },
    "LogExceptionWithContext": {
      "line_numbers": [186],
      "current_implementation": "logger.LogError(ex, message)",
      "issues": [
        "Basic error logging without Spectre markup",
        "Structured context added to scope but not visible in log message"
      ],
      "recommended_fix": "Use existing LogTemplates.LogCriticalError()",
      "existing_template": "LogCriticalError (lines 390-395 in LogTemplates.cs)",
      "suggested_spectre_markup": "[red bold]CRITICAL[/] [grey]|[/] [cyan]{operation}[/] [dim]â†’[/] [red]{ExceptionType}[/]: {message}",
      "priority": "HIGH",
      "benefits": [
        "Bold red critical indicator",
        "Exception type highlighted",
        "Consistent error formatting"
      ]
    },
    "LogAssetLoaded": {
      "line_numbers": [208, 217],
      "current_implementation": "Conditional LogWarning/LogDebug with 'A' prefix",
      "issues": [
        "Has hardcoded 'A' prefix instead of using Accent",
        "No Spectre markup colors",
        "Similar to existing asset templates"
      ],
      "recommended_fix": "Use existing LogTemplates.LogAssetLoadedWithTiming() or LogSlowTextureLoad()",
      "existing_templates": [
        "LogAssetLoadedWithTiming (lines 144-156 in LogTemplates.cs)",
        "LogTextureLoaded (lines 748-753 in LogTemplates.cs)",
        "LogSlowTextureLoad (lines 758-762 in LogTemplates.cs)"
      ],
      "migration_strategy": "Use LogSlowTextureLoad for >50ms threshold, LogAssetLoadedWithTiming for normal loading",
      "priority": "HIGH",
      "benefits": [
        "Asset accent with aqua color ([aqua]A[/])",
        "Color-coded timing (green <100ms, yellow >100ms)",
        "Consistent with other asset operations"
      ]
    }
  },
  "detailed_line_mapping": [
    {
      "line": 40,
      "method": "LogEntityCreated",
      "current_code": "logger.LogInformation(message, args.ToArray())",
      "recommended_replacement": "LogTemplates.LogEntityCreated(logger, entityType, entityId, ...components)",
      "spectre_markup_needed": true,
      "existing_template": "Yes - LogTemplates.LogEntityCreated"
    },
    {
      "line": 61,
      "method": "LogComponentAdded",
      "current_code": "logger.LogDebug(\"Component added | entity: {EntityId}, component: {ComponentType}, data: {@ComponentData}\", entityId, componentType, componentData)",
      "recommended_replacement": "NEW TEMPLATE NEEDED: LogComponentAdded with optional data parameter",
      "spectre_markup_needed": true,
      "existing_template": "No - needs new template"
    },
    {
      "line": 70,
      "method": "LogComponentAdded",
      "current_code": "logger.LogDebug(\"Component added | entity: {EntityId}, component: {ComponentType}\", entityId, componentType)",
      "recommended_replacement": "NEW TEMPLATE NEEDED: LogComponentAdded with optional data parameter",
      "spectre_markup_needed": true,
      "existing_template": "No - needs new template"
    },
    {
      "line": 97,
      "method": "LogSystemExecution",
      "current_code": "logger.LogWarning(\"System execution slow | system: {SystemName}, time: {ExecutionTimeMs:F2}ms, entities: {EntitiesProcessed}\", systemName, executionTimeMs, entitiesProcessed)",
      "recommended_replacement": "LogTemplates.LogSlowSystem(logger, systemName, executionTimeMs, percent)",
      "spectre_markup_needed": true,
      "existing_template": "Yes - LogTemplates.LogSlowSystem"
    },
    {
      "line": 106,
      "method": "LogSystemExecution",
      "current_code": "logger.LogDebug(\"System executed | system: {SystemName}, time: {ExecutionTimeMs:F2}ms, entities: {EntitiesProcessed}\", systemName, executionTimeMs, entitiesProcessed)",
      "recommended_replacement": "LogTemplates.LogSystemPerformance(logger, systemName, avgMs, maxMs, calls) OR LogTemplates.LogSystemUpdateCompleted from Generated.cs",
      "spectre_markup_needed": true,
      "existing_template": "Yes - Multiple options available"
    },
    {
      "line": 143,
      "method": "LogWorkflow",
      "current_code": "logger.LogInformation(message, args.ToArray())",
      "recommended_replacement": "LogTemplates.LogWorkflowStatus(logger, workflowName + \" \" + status, ...details)",
      "spectre_markup_needed": true,
      "existing_template": "Yes - LogTemplates.LogWorkflowStatus"
    },
    {
      "line": 186,
      "method": "LogExceptionWithContext",
      "current_code": "logger.LogError(ex, message)",
      "recommended_replacement": "LogTemplates.LogCriticalError(logger, ex, message)",
      "spectre_markup_needed": true,
      "existing_template": "Yes - LogTemplates.LogCriticalError"
    },
    {
      "line": 208,
      "method": "LogAssetLoaded",
      "current_code": "logger.LogWarning(\"A   Asset loaded (slow) | path: {AssetPath}, type: {AssetType}, time: {LoadTimeMs:F2}ms\", assetPath, assetType, loadTimeMs)",
      "recommended_replacement": "LogTemplates.LogSlowTextureLoad(logger, assetPath, loadTimeMs)",
      "spectre_markup_needed": true,
      "existing_template": "Yes - LogTemplates.LogSlowTextureLoad"
    },
    {
      "line": 217,
      "method": "LogAssetLoaded",
      "current_code": "logger.LogDebug(\"A   Asset loaded | path: {AssetPath}, type: {AssetType}, time: {LoadTimeMs:F2}ms\", assetPath, assetType, loadTimeMs)",
      "recommended_replacement": "LogTemplates.LogAssetLoadedWithTiming(logger, assetPath, loadTimeMs, width, height) OR LogTemplates.LogTextureLoaded",
      "spectre_markup_needed": true,
      "existing_template": "Yes - Multiple options available"
    },
    {
      "line": 249,
      "method": "TimedOperationScope constructor",
      "current_code": "logger.LogDebug(\"Operation started | operation: {OperationName}\", operationName)",
      "recommended_replacement": "LogTemplates.LogWorkflowStatus(logger, \"Operation started: \" + operationName)",
      "spectre_markup_needed": true,
      "existing_template": "Yes - LogTemplates.LogWorkflowStatus"
    },
    {
      "line": 259,
      "method": "TimedOperationScope.Dispose",
      "current_code": "logger.LogWarning(\"Operation completed (slow) | operation: {OperationName}, time: {ElapsedMs:F2}ms, threshold: {ThresholdMs:F2}ms\", _operationName, elapsedMs, _warnThresholdMs)",
      "recommended_replacement": "LogTemplates.LogSlowOperation(logger, _operationName, elapsedMs, _warnThresholdMs)",
      "spectre_markup_needed": true,
      "existing_template": "Yes - LogTemplates.LogSlowOperation"
    },
    {
      "line": 268,
      "method": "TimedOperationScope.Dispose",
      "current_code": "logger.LogDebug(\"Operation completed | operation: {OperationName}, time: {ElapsedMs:F2}ms\", _operationName, elapsedMs)",
      "recommended_replacement": "LogTemplates.LogBatchCompleted or LogWorkflowStatus",
      "spectre_markup_needed": true,
      "existing_template": "Yes - LogTemplates.LogBatchCompleted or LogWorkflowStatus"
    }
  ],
  "color_scheme_recommendations": {
    "Entity": {
      "accent": "[gold1]E[/]",
      "primary_color": "yellow",
      "secondary_color": "cyan",
      "dim_color": "dim"
    },
    "System": {
      "accent": "[orange3]SYS[/]",
      "primary_color": "cyan",
      "performance_colors": {
        "good": "green",
        "warning": "yellow",
        "critical": "red"
      }
    },
    "Asset": {
      "accent": "[aqua]A[/]",
      "primary_color": "cyan",
      "timing_colors": {
        "fast": "green",
        "slow": "yellow"
      }
    },
    "Workflow": {
      "accent": "[steelblue1]WF[/]",
      "primary_color": "cyan",
      "status_color": "yellow"
    },
    "Performance": {
      "accent": "[plum1]P[/]",
      "threshold_colors": {
        "good": "green",
        "warning": "yellow",
        "critical": "red"
      }
    },
    "Error": {
      "critical": "red bold",
      "error": "red",
      "warning": "yellow"
    }
  },
  "new_templates_needed": [
    {
      "method_name": "LogComponentAdded",
      "signature": "LogComponentAdded(ILogger logger, int entityId, string componentType, object? componentData = null)",
      "accent": "Entity",
      "suggested_markup": "[gold1]E[/] [dim]Component added[/] | entity: [yellow]{entityId}[/] | component: [cyan]{componentType}[/] [dim]{componentData}[/]",
      "log_level": "Debug",
      "reason": "Currently has two separate manual LogDebug calls with conditional logic"
    }
  ],
  "migration_priority_queue": [
    {
      "rank": 1,
      "method": "LogSystemExecution",
      "reason": "Performance-critical, existing templates available, high visual impact",
      "existing_templates": ["LogSlowSystem", "LogSystemPerformance", "LogSystemUpdateCompleted"],
      "estimated_improvement": "3-5x better readability with color-coded thresholds"
    },
    {
      "rank": 2,
      "method": "LogAssetLoaded",
      "reason": "Frequently called during loading, existing templates available",
      "existing_templates": ["LogSlowTextureLoad", "LogAssetLoadedWithTiming", "LogTextureLoaded"],
      "estimated_improvement": "Consistent asset loading visualization"
    },
    {
      "rank": 3,
      "method": "LogExceptionWithContext",
      "reason": "Critical errors need maximum visibility",
      "existing_templates": ["LogCriticalError"],
      "estimated_improvement": "Bold red formatting makes errors impossible to miss"
    },
    {
      "rank": 4,
      "method": "LogEntityCreated",
      "reason": "Entity operations are core to ECS system",
      "existing_templates": ["LogEntityCreated"],
      "estimated_improvement": "Consistent entity formatting with component list"
    },
    {
      "rank": 5,
      "method": "LogWorkflow",
      "reason": "Workflow tracking consistency",
      "existing_templates": ["LogWorkflowStatus"],
      "estimated_improvement": "Matches other workflow operations"
    },
    {
      "rank": 6,
      "method": "BeginTimedOperation",
      "reason": "Performance tracking enhancement",
      "existing_templates": ["LogSlowOperation", "LogBatchCompleted"],
      "estimated_improvement": "Better performance visualization"
    },
    {
      "rank": 7,
      "method": "LogComponentAdded",
      "reason": "Needs new template creation",
      "existing_templates": null,
      "estimated_improvement": "Requires new template development first"
    }
  ],
  "statistics": {
    "total_lines_of_code": 279,
    "manual_logging_lines": 15,
    "percentage_manual": "5.4%",
    "conversion_coverage": {
      "can_use_existing_templates": 13,
      "needs_new_templates": 2,
      "existing_template_coverage": "86.7%"
    },
    "spectre_markup_usage": {
      "current": 0,
      "after_migration": 15,
      "improvement": "100%"
    }
  },
  "implementation_notes": {
    "notes": [
      "All LoggerMessage templates in LogTemplates.Generated.cs already support Spectre markup via LogFormatting.FormatTemplate()",
      "Accent styles are centralized in LogTemplates.cs AccentStyles dictionary with 11 predefined categories",
      "Helper methods (FormatDetails, FormatComponents, EscapeMarkup) are already available for template creation",
      "LogFormatting.EscapeMarkup() MUST be used for all user-provided strings to prevent Spectre markup injection",
      "Conditional logic (e.g., time thresholds) should use separate templates rather than if/else in extension methods"
    ],
    "breaking_changes": [
      "LogWorkflow() currently returns no value, but template methods may need different signatures",
      "BeginTimedOperation() returns IDisposable, may need adapter pattern to use templates",
      "Scopes are used extensively in current implementation, ensure templates preserve scope data"
    ],
    "performance_considerations": [
      "Source-generated LoggerMessage templates are zero-allocation",
      "Manual string concatenation in current code creates garbage",
      "Template methods pre-allocate formatting strings for better performance"
    ]
  }
}
